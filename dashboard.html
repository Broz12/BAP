<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard | MLBB Pro Top-Up</title>

    <meta name="supabase-url" content="" />
    <meta name="supabase-anon-key" content="" />
    <meta name="stripe-publishable-key" content="" />
    <meta name="app-base-url" content="" />
    <meta name="admin-whatsapp-number" content="" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./css/style.css" />
    <script src="./js/runtime-config.js"></script>
  </head>
  <body>
    <div id="loadingOverlay" class="loading-overlay">
      <div class="spinner" aria-label="Loading"></div>
    </div>

    <header class="navbar">
      <div class="inner">
        <a href="index.html" class="brand">
          <span class="brand-mark">â—†</span>
          <span>MLBB Pro Top-Up</span>
        </a>
        <nav class="nav-links">
          <a data-nav-link href="index.html">Home</a>
          <a data-nav-link href="topup.html">Top-Up</a>
          <a data-nav-link href="dashboard.html">Dashboard</a>
          <a data-nav-link href="admin.html">Admin</a>
          <select id="currencySelect" class="select" style="max-width: 94px"></select>
          <span id="walletBadge" class="wallet-badge hidden"></span>
          <button data-logout class="btn secondary">Logout</button>
        </nav>
      </div>
    </header>

    <main>
      <section class="section" data-animate>
        <h2>User Profile</h2>
        <div class="grid three">
          <article class="card glass">
            <div class="label">Email</div>
            <div id="profileEmail" style="font-weight: 700"></div>
          </article>
          <article class="card glass">
            <div class="label">Role</div>
            <div id="profileRole" style="font-weight: 700"></div>
          </article>
          <article class="card glass">
            <div class="label">Joined</div>
            <div id="profileJoined" style="font-weight: 700"></div>
          </article>
        </div>
      </section>

      <section class="section" data-animate>
        <h2>Wallet</h2>
        <div class="grid two">
          <article class="card glass">
            <div class="stat-label">Wallet Balance (USD)</div>
            <div id="walletBalanceUsd" class="stat-value">$0.00</div>
            <div class="label" id="walletBalanceLocal">$0.00</div>
            <div class="inline-actions" style="margin-top: 0.8rem">
              <button class="btn" data-modal-open="depositModal">Deposit Funds</button>
            </div>
          </article>

          <article class="card glass">
            <h3 style="margin-top: 0">Wallet Transactions</h3>
            <div class="table-wrap">
              <table class="table">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Amount (USD)</th>
                    <th>Amount (Local)</th>
                  </tr>
                </thead>
                <tbody id="walletTransactionsBody"></tbody>
              </table>
            </div>
          </article>
        </div>
      </section>

      <section class="section" data-animate>
        <h2>Referral Program</h2>
        <div class="grid two">
          <article class="card glass">
            <p class="label">Your referral code</p>
            <p id="referralCode" style="font-weight: 700; font-size: 1.2rem; margin-top: 0">-</p>
            <label class="label" for="referralLink">Referral link</label>
            <input id="referralLink" class="input" readonly />
            <div class="inline-actions" style="margin-top: 0.6rem">
              <button class="btn secondary" id="copyReferralBtn">Copy Link</button>
            </div>
          </article>

          <article class="card glass">
            <div class="grid three">
              <div>
                <p class="label">Total Referrals</p>
                <p id="refTotal" class="stat-value">0</p>
              </div>
              <div>
                <p class="label">Commission (USD)</p>
                <p id="refEarnedUsd" class="stat-value">$0.00</p>
              </div>
              <div>
                <p class="label">Commission (Local)</p>
                <p id="refEarnedLocal" class="stat-value">$0.00</p>
              </div>
            </div>
            <div class="table-wrap" style="margin-top: 0.8rem">
              <table class="table">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Referred User</th>
                    <th>USD</th>
                    <th>Local</th>
                  </tr>
                </thead>
                <tbody id="referralBody"></tbody>
              </table>
            </div>
          </article>
        </div>
      </section>

      <section class="section" data-animate>
        <h2>Order History & Invoices</h2>
        <div class="card glass table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Package</th>
                <th>Player</th>
                <th>Amount</th>
                <th>Local</th>
                <th>Payment</th>
                <th>Status</th>
                <th>Date</th>
                <th>Invoice</th>
              </tr>
            </thead>
            <tbody id="orderHistoryBody"></tbody>
          </table>
        </div>
      </section>
    </main>

    <section class="modal" id="depositModal" aria-label="Deposit modal">
      <div class="modal-content">
        <h3 style="margin-top: 0">Deposit Wallet</h3>
        <form id="depositForm" class="form-row">
          <div>
            <label class="label" for="depositAmount">Amount</label>
            <input id="depositAmount" class="input" type="number" min="1" step="0.01" required />
          </div>
          <div>
            <label class="label" for="depositCurrency">Currency</label>
            <select id="depositCurrency" class="select"></select>
          </div>
          <div class="inline-actions">
            <button type="submit" class="btn">Continue to Stripe</button>
            <button type="button" class="btn secondary" data-modal-close>Cancel</button>
          </div>
        </form>
      </div>
    </section>

    <div class="mobile-bottom-nav">
      <nav class="menu">
        <a data-nav-link href="index.html">Home</a>
        <a data-nav-link href="topup.html">Top-Up</a>
        <a data-nav-link href="dashboard.html">Dashboard</a>
        <a data-nav-link href="admin.html">Admin</a>
      </nav>
    </div>

    <footer class="footer-note">
      <p><strong>Disclaimer:</strong> This website is not affiliated with Moonton or Mobile Legends.</p>
    </footer>

    <script type="module">
      import { initDashboardPage } from "./js/dashboard.js";
      initDashboardPage();
    </script>
  </body>
</html>
